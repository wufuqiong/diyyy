var D=Object.defineProperty;var B=(c,o,e)=>o in c?D(c,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[o]=e;var f=(c,o,e)=>B(c,typeof o!="symbol"?o+"":o,e);import{r as F,af as L,j as t,B as p,ac as G,P as k,w as y,T as _,a as O}from"./index-DmQwDool.js";import{C as V}from"./config-global-BGRABV9D.js";import{m as U,C as Z,N as X,a as J,P as Q}from"./miemie-words-Dw1EPFgO.js";import{F as C,I,T as Y}from"./TextField-CbDoq9du.js";import{S as W}from"./Select-Chqb64u5.js";import{M as P}from"./MenuItem-CgwgWWJB.js";import{G as j}from"./Grid-DDP5NrWp.js";import"./dividerClasses-BOX9wxsb.js";const q={},K={"小羊上山-1级":["十八","走了","小花","十二","小虫","天上","白天","天亮了","看了又看","小鸟","大山","一天","下来","跳高","一两","二月","树下","天地","太好","六十","看一下","又快又好","多好","马上","笑一笑","太阳","我爸爸","三月","四天","一只","大树","八天","不是","树上","好多","草地","八月","十只","高兴","高高的","二十","快乐","五月","飞鸟","九月","十六","十五","四月","五天","我妈妈","好的","头上","飞快","小羊","小草","太大","月亮","大马","爸爸","好笑","花草","好了","是的","两只","白兔","一头牛","走来走去","跳上跳下","流通","小兔","好吃","我的","十一","一天又一天","四十","牛羊","少不了","高山","六月","三十","不好","三天","上来","多少","上山","白云","大小","好看","大地","十九","星星","妈妈","两天","吃草","九天"],"小羊上山-2级":[],"小羊上山-3级":[],"小羊上山-4级":[],"小羊上山-5级":[],"小羊上山-6级":[]},ee={English:q,Chinese:K},H=c=>{const o=["icons/fruits_and_vegetables/color/bok-choy.png","icons/fruits_and_vegetables/color/mushroom.png","icons/fruits_and_vegetables/color/kale.png","icons/fruits_and_vegetables/color/peach.png","icons/fruits_and_vegetables/color/grapefruit.png","icons/fruits_and_vegetables/color/cauliflower.png","icons/fruits_and_vegetables/color/lime.png","icons/fruits_and_vegetables/color/potato.png","icons/fruits_and_vegetables/color/corn.png","icons/fruits_and_vegetables/color/chard.png","icons/fruits_and_vegetables/color/coconut.png","icons/fruits_and_vegetables/color/beet.png","icons/fruits_and_vegetables/color/carrot.png","icons/fruits_and_vegetables/color/blueberry.png","icons/fruits_and_vegetables/color/pineapple.png","icons/fruits_and_vegetables/color/artichoke.png","icons/fruits_and_vegetables/color/mango.png","icons/fruits_and_vegetables/color/tomato.png","icons/fruits_and_vegetables/color/watermelon.png","icons/fruits_and_vegetables/color/cherry.png","icons/fruits_and_vegetables/color/orange.png","icons/fruits_and_vegetables/color/apple.png","icons/fruits_and_vegetables/color/date.png","icons/fruits_and_vegetables/color/lychee.png","icons/fruits_and_vegetables/color/kohlrabi.png","icons/fruits_and_vegetables/color/plantain.png","icons/fruits_and_vegetables/color/pear.png","icons/fruits_and_vegetables/color/leek.png","icons/fruits_and_vegetables/color/dragon-fruit.png","icons/fruits_and_vegetables/color/collard-greens.png","icons/fruits_and_vegetables/color/cucumber.png","icons/fruits_and_vegetables/color/banana.png","icons/fruits_and_vegetables/color/plum.png","icons/fruits_and_vegetables/color/eggplant.png","icons/fruits_and_vegetables/color/spinach.png","icons/fruits_and_vegetables/color/cabbage.png","icons/fruits_and_vegetables/color/strawberry.png","icons/fruits_and_vegetables/color/lettuce.png","icons/fruits_and_vegetables/color/jackfruit.png","icons/fruits_and_vegetables/color/pumpkin.png","icons/fruits_and_vegetables/color/radish.png","icons/fruits_and_vegetables/color/kiwi.png","icons/fruits_and_vegetables/color/soursop.png","icons/fruits_and_vegetables/color/broccoli.png"];return F.useMemo(()=>{let e=0;for(let r=0;r<c.length;r++)e=(e*31+c.charCodeAt(r))%1000000007;const n=Math.abs(e)%o.length;return o[n]},[c])},T=[{name:"8 x 8",rows:8,cols:8},{name:"9 x 9",rows:9,cols:9},{name:"10 x 10",rows:10,cols:10},{name:"12 x 12",rows:12,cols:12}],S=U,te=ee,se={WORD:"单字迷宫",PHRASE:"请找到以下词语",SENTENCE:"请找到以下句子"},R={WORD:"单字练习",PHRASE:"词语练习",SENTENCE:"句子练习"},ne={WORD:"预设字库",PHRASE:"预设词库",SENTENCE:"预设句库"},z={WORD:S,PHRASE:te,SENTENCE:S},E=300,re="人教版小学语文一年级上册",ae="A-Z大写字母",ie="a-z小写字母",$=c=>{const o=[...c];for(let e=o.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[o[e],o[n]]=[o[n],o[e]]}return o},oe=(c,o)=>{const e=Array.from({length:c},()=>Array.from({length:o},()=>0)),n=[],r=(a,s)=>{if(a==c-1&&s==o-1)return n.push([a,s]),!0;e[a][s]=1,n.push([a,s]);let i=[[0,1],[0,-1],[1,0],[-1,0]];i=$(i);for(let u=0;u<i.length;u++){const l=i[u][0]+a,h=i[u][1]+s;if(l>=0&&h>=0&&l<c&&h<o&&e[l][h]==0){let d=0;for(let g=0;g<i.length;g++){const m=i[g][0]+l,x=i[g][1]+h;m>=0&&x>=0&&m<c&&x<o&&(d+=e[m][x])}if(d<=1&&r(l,h))return!0}}return n.pop(),e[a][s]=0,!1};return r(0,0)?n:[]},le=(c,o,e)=>{const n=Array(o).fill(null).map(()=>Array(e).fill("")),r=[],a=[...c].sort((u,l)=>l.length-u.length),s=Math.floor(o/2),i=Math.floor(e/2);for(const u of a){let l=!1;for(let h=0;h<=Math.max(o,e)&&!l;h++)for(let d=-h;d<=h&&!l;d++)for(let g=-h;g<=h&&!l;g++){if(Math.abs(d)+Math.abs(g)!==h)continue;const m=s+d,x=i+g;if(m>=0&&m<o&&x>=0&&x<e){const b=["horizontal","vertical"];b.sort(()=>Math.random()-.5);for(const v of b)if(ce(n,u,m,x,v,o,e)){const M=he(n,u,m,x,v);r.push({word:u,positions:M}),l=!0;break}}}if(!l)break}return r},ce=(c,o,e,n,r,a,s)=>{if(r==="horizontal"){if(n+o.length>s)return!1;for(let i=0;i<o.length;i++)if(c[e][n+i]!=="")return!1}else{if(e+o.length>a)return!1;for(let i=0;i<o.length;i++)if(c[e+i][n]!=="")return!1}return!0},he=(c,o,e,n,r)=>{const a=[];if(r==="horizontal")for(let s=0;s<o.length;s++)c[e][n+s]=o[s],a.push([e,n+s]);else for(let s=0;s<o.length;s++)c[e+s][n]=o[s],a.push([e+s,n]);return a},N=({char:c})=>{const o=H(`maze-page-start-icon-${c}`);return t.jsx("img",{src:o,alt:"start icon",style:{width:"2em",height:"2em",verticalAlign:"middle"}})},w=({char:c})=>{const o=H(`maze-page-end-icon-${c}`);return t.jsx("img",{src:o,alt:"end icon",style:{width:"2em",height:"2em",verticalAlign:"middle"}})};function de(c){const o=/[\u4e00-\u9fff]/;return c.some(e=>o.test(e))}class ge extends L.Component{constructor(e){super(e);f(this,"parseSelectedMode",e=>Object.keys(R)[e]);f(this,"handleUserInputChange",e=>{const n=e.target.value;n.length<=E&&this.setState({userInput:n})});f(this,"handleModeChange",e=>{this.setState({selectedMode:e.target.value})});f(this,"handleTableSizeChange",e=>{this.setState({selectedTableSize:e.target.value})});f(this,"handleLevelChange",e=>{const n=e.target.value;if(n.includes("|")){const[r,a]=n.split("|");this.setState({selectedLanguage:r,selectedLevel:a,fullSelectedValue:n});const s=this.parseSelectedMode(this.state.selectedMode),i=z[s][r][a];this.setState({userInput:i.join(",")})}else this.setState({selectedLanguage:"",selectedLevel:"",fullSelectedValue:""})});f(this,"handleClearInput",()=>{this.setState({userInput:"",pages:[]})});f(this,"filterChineseCharacters",e=>e.replace(/[^\u4e00-\u9fff]/g,""));f(this,"generateMaze",(e,n,r,a)=>{const s=[];let i=[];de(e)?i=S.Chinese[re]||[]:(i=[...S.English[ae],...S.English[ie]],i=[...i,...i,...i]),i=$(i);for(let u=0;u<n;u++){const l=[];for(let h=0;h<r;h++)l.push(i[u*n+h]);s.push(l)}if(a=="WORD"){const u=e[0],l=oe(n,r);for(let h=0;h<l.length;h++){const d=u[Math.floor(Math.random()*u.length)];s[l[h][0]][l[h][1]]=d}}return a=="PHRASE"&&le(e,n,r).forEach(l=>{const{word:h,positions:d}=l;for(let g=0;g<h.length;g++)s[d[g][0]][d[g][1]]=h[g]}),s});f(this,"generatePages",()=>{const{selectedMode:e,selectedTableSize:n}=this.state,{userInput:r}=this.state;if(!r.trim()){alert("请输入要练习的文字");return}const a=T[n].rows,s=T[n].cols,i=this.parseSelectedMode(e),u=[];this.setState({userInput:r},()=>{if(i=="WORD"){let l=[];r.trim()!==""&&(l=r.split(/[\s,;，；、]+/).filter(d=>d.trim()!=="")),l.length===0&&r.trim()!==""&&(l=r.split("").filter(d=>d.trim()!==""));const h=l.length;for(let d=0;d<h;d++){const g=this.generateMaze([l[d]],a,s,i);u.push({refChars:[l[d]],chars:g,rows:a,cols:s,mode:i})}}if(i=="PHRASE"){let l=[];r.trim()!==""&&(l=r.split(/[\s,;，；、]+/).filter(g=>g.trim()!==""));const d=Math.ceil(l.length/5);for(let g=0;g<d;g++){const m=g*5,x=m+5,b=l.slice(m,x),v=this.generateMaze(b,a,s,i);u.push({refChars:b,chars:v,rows:a,cols:s,mode:i})}}this.setState({pages:u})})});f(this,"getWordLibSelecter",e=>{const n=ne[e],r=z[e];return t.jsxs(C,{fullWidth:!0,children:[t.jsx(I,{children:n}),t.jsxs(W,{value:this.state.fullSelectedValue,onChange:this.handleLevelChange,label:n,children:[t.jsx(P,{value:"",children:"请选择"}),Object.keys(r).map(a=>Object.keys(r[a]).map(s=>t.jsxs(P,{value:`${a}|${s}`,children:[a," - ",s]},`${a}-${s}`)))]})]})});this.state={userInput:"",selectedMode:0,selectedTableSize:0,selectedLevel:"",selectedLanguage:"",fullSelectedValue:"",pages:[]}}render(){const{userInput:e,selectedMode:n,selectedTableSize:r,pages:a}=this.state;return t.jsx(p,{className:"app",sx:{p:2},children:t.jsx(G,{maxWidth:"lg",children:t.jsxs(j,{container:!0,spacing:3,children:[t.jsx(j,{size:{xs:12,md:12},sx:{"@media print":{display:"none"}},children:t.jsxs(k,{sx:{p:3},children:[t.jsx(p,{sx:{mb:3},children:t.jsxs(C,{fullWidth:!0,children:[t.jsxs(p,{sx:{display:"flex",gap:1,alignItems:"flex-start"},children:[t.jsx(Y,{multiline:!0,rows:3,value:e,onChange:this.handleUserInputChange,placeholder:`请输入最多${E}个要练习的文字`,inputProps:{maxLength:E},fullWidth:!0,variant:"outlined"}),t.jsx(y,{onClick:this.handleClearInput,disabled:!e,color:"error",sx:{mt:.5},children:t.jsx(Z,{})})]}),t.jsxs(_,{variant:"caption",color:"textSecondary",sx:{mt:1},children:["已输入 ",e.length,"/",E," 字"]})]})}),t.jsxs(j,{container:!0,spacing:2,sx:{mb:3},children:[t.jsx(j,{size:{xs:12,sm:4},children:t.jsxs(C,{fullWidth:!0,children:[t.jsx(I,{children:"模式选择"}),t.jsx(W,{value:n,onChange:this.handleModeChange,label:"练习模式",children:Object.keys(R).map((s,i)=>t.jsx(P,{value:i,children:R[s]},i))})]})}),t.jsx(j,{size:{xs:12,sm:4},children:t.jsxs(C,{fullWidth:!0,children:[t.jsx(I,{children:"迷宫尺寸"}),t.jsx(W,{value:r,onChange:this.handleTableSizeChange,label:"迷宫尺寸",children:T.map((s,i)=>t.jsx(P,{value:i,children:s.name},i))})]})}),t.jsx(j,{size:{xs:12,sm:4},children:this.getWordLibSelecter(this.parseSelectedMode(n))})]}),t.jsx(O,{variant:"contained",fullWidth:!0,onClick:this.generatePages,disabled:!e.trim(),size:"large",sx:{"@media print":{display:"none"}},children:"生成练习页"})]})}),t.jsx(j,{size:{xs:12,md:12},sx:{"@media print":{width:"100%",maxWidth:"100%",flexBasis:"100%"}},children:t.jsx(k,{sx:{p:3,minHeight:400,"@media print":{boxShadow:"none",border:"none",minHeight:"auto"}},children:a.length>0?t.jsx(ue,{pages:a.map((s,i)=>({refChars:s.refChars,characters:s.chars,rows:s.rows,cols:s.cols,mode:s.mode,pageNumber:i+1,totalPages:a.length}))}):t.jsx(p,{sx:{textAlign:"center",py:8,"@media print":{display:"none"}},children:t.jsx(_,{variant:"h6",color:"textSecondary",children:'请输入文字并点击"生成练习页"来预览'})})})})]})})})}}class ue extends L.Component{constructor(e){super(e);f(this,"goToPreviousPage",()=>{this.setState(e=>({currentPage:Math.max(0,e.currentPage-1)}))});f(this,"goToNextPage",()=>{const{pages:e}=this.props;this.setState(n=>({currentPage:Math.min(e.length-1,n.currentPage+1)}))});f(this,"goToPage",e=>{this.setState({currentPage:e})});f(this,"generatePageIndicators",()=>{const{pages:e}=this.props,{currentPage:n}=this.state,r=e.length;if(r<=7)return Array.from({length:r},(s,i)=>i);const a=[];if(a.push(0),n<=3){for(let s=1;s<=4;s++)a.push(s);a.push("ellipsis"),a.push(r-2),a.push(r-1)}else if(n>=r-4){a.push("ellipsis");for(let s=r-5;s<r;s++)s>0&&a.push(s)}else{a.push("ellipsis");for(let s=n-2;s<=n+2;s++)a.push(s);a.push("ellipsis"),a.push(r-1)}return a});f(this,"getWordModeInstruction",(e,n,r)=>t.jsx(p,{sx:{textAlign:"center",mb:3,p:2},children:t.jsxs(_,{variant:"h4",sx:{fontWeight:"bold",color:"primary.main"},children:["请从",n,"出发， 沿着",t.jsx(p,{component:"span",sx:{display:"inline-block",mx:1,px:2,py:.5,backgroundColor:"primary.main",color:"white",borderRadius:1,fontWeight:"bold",fontSize:"1.2em"},children:e}),"字走，走到",r,"处。"]})}));f(this,"getPhraseModeInstruction",e=>t.jsx(p,{sx:{textAlign:"center",mb:3,p:2},children:t.jsx(_,{variant:"h4",sx:{fontWeight:"bold",color:"primary.main"},children:e.map(n=>t.jsx(p,{component:"span",sx:{display:"inline-block",mx:1,px:2,py:.5,backgroundColor:"primary.main",color:"white",borderRadius:1,fontWeight:"bold",fontSize:"1.2em"},children:n}))})}));f(this,"getInstruction",(e,n)=>{switch(console.log(n),e){case"WORD":return this.getWordModeInstruction(n[0],t.jsx(N,{char:n[0]}),t.jsx(w,{char:n[0]}));case"PHRASE":return this.getPhraseModeInstruction(n);case"SENTENCE":return t.jsx(t.Fragment,{});default:return t.jsx(t.Fragment,{})}});f(this,"renderPage",e=>{const{refChars:n,characters:r,rows:a,cols:s,mode:i}=e,u=a*s;return t.jsxs(p,{sx:{p:2},children:[t.jsx(_,{variant:"h2",align:"center",gutterBottom:!0,sx:{fontWeight:"bold",my:4},children:se[i]}),this.getInstruction(i,n),t.jsx(p,{sx:{display:"grid",gridTemplateColumns:`repeat(${s}, 0fr)`,margin:"0 auto",justifyContent:"center",maxWidth:"fit-content"},children:Array.from({length:u}).map((l,h)=>{var A;const d=Math.floor(h/s),g=h%s,m=((A=r[d])==null?void 0:A[g])||"",x=d===0&&g===0&&i==="WORD",b=d===a-1&&g===s-1&&i==="WORD",v=20*8/a,M=20*8/s;return t.jsxs(p,{sx:{width:`${v}mm`,height:`${M}mm`,aspectRatio:"1",border:"1pt solid #333",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"white",position:"relative"},children:[!x&&!b&&t.jsx(_,{variant:"h3",children:m}),x&&t.jsx(N,{char:n[0]}),b&&t.jsx(w,{char:n[0]})]},h)})})]})});f(this,"handlePrint",()=>{window.print()});this.state={currentPage:0}}render(){const{pages:e}=this.props,{currentPage:n}=this.state;return!e||e.length===0?t.jsx(p,{sx:{textAlign:"center",py:8},children:t.jsx(_,{variant:"h6",color:"textSecondary",children:"没有可预览的页面"})}):t.jsxs(p,{children:[t.jsxs(p,{sx:{"@media print":{display:"none"}},children:[t.jsx(p,{sx:{mb:2},children:t.jsxs(p,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:2},children:[t.jsx(y,{onClick:this.goToPreviousPage,disabled:n===0,children:t.jsx(X,{})}),t.jsx(p,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:this.generatePageIndicators().map((r,a)=>r==="ellipsis"?t.jsx(_,{sx:{px:1},children:"..."},`ellipsis-${a}`):t.jsx(y,{onClick:()=>this.goToPage(r),color:r===n?"primary":"default",size:"small",children:r+1},r))}),t.jsx(y,{onClick:this.goToNextPage,disabled:n===e.length-1,children:t.jsx(J,{})})]})}),t.jsx(p,{sx:{mb:3},children:this.renderPage(e[n])}),t.jsx(p,{sx:{textAlign:"center"},children:t.jsxs(O,{variant:"outlined",startIcon:t.jsx(Q,{}),onClick:this.handlePrint,children:["打印所有页面 (",e.length,"页)"]})})]}),t.jsx(p,{sx:{display:"none","@media print":{display:"block"}},children:e.map((r,a)=>t.jsx(p,{sx:{breakAfter:"page",pageBreakAfter:"always","&:last-child":{breakAfter:"auto",pageBreakAfter:"auto"}},children:this.renderPage(r)},a))})]})}}function Ce(){return t.jsxs(t.Fragment,{children:[t.jsx("title",{children:`Chinese Maze - ${V.appName}`}),t.jsx(ge,{})]})}export{Ce as default};
