var A=Object.defineProperty;var B=(h,c,t)=>c in h?A(h,c,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[c]=t;var d=(h,c,t)=>B(h,typeof c!="symbol"?c+"":c,t);import{af as L,j as e,B as o,ac as N,P as w,w as F,T as x,a as k}from"./index-DmQwDool.js";import{C as T}from"./config-global-BGRABV9D.js";import{m as E,C as R,N as M,a as _,P as z}from"./miemie-words-Dw1EPFgO.js";import{G as p}from"./Grid-DDP5NrWp.js";import{F as C,T as $,I as b}from"./TextField-CbDoq9du.js";import{S}from"./Select-Chqb64u5.js";import{M as g}from"./MenuItem-CgwgWWJB.js";import"./dividerClasses-BOX9wxsb.js";const m=E,P=300,G="人教版小学语文一年级上册",H="A-Z大写字母",O="a-z小写字母",I=[{name:"经典组合",colors:["#FF6B6B","#f5b63aff","#45B7D1","#51db8dff","#F7DC6F"]},{name:"柔和组合",colors:["#FF9999","#66CCCC","#9999FF","#FFCC99","#CC99FF"]},{name:"鲜艳组合",colors:["#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF"]},{name:"自然组合",colors:["#8B4513","#228B22","#1E90FF","#FFD700","#FF6347"]}],v=h=>{const c=[...h];for(let t=c.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[c[t],c[n]]=[c[n],c[t]]}return c};class V extends L.Component{constructor(t){super(t);d(this,"handleUserInputChange",t=>{const n=t.target.value;n.length<=P&&this.setState({userInput:n})});d(this,"handleWordsPerPageChange",t=>{this.setState({wordsPerPage:t.target.value})});d(this,"handleColorPresetChange",t=>{const n=t.target.value;this.setState({selectedPreset:n})});d(this,"handleLevelChange",t=>{const n=t.target.value;if(n.includes("|")){const[s,r]=n.split("|");this.setState({selectedLanguage:s,selectedLevel:r,fullSelectedValue:n});const l=m[s][r];this.setState({userInput:l.join(",")})}else this.setState({selectedLanguage:"",selectedLevel:"",fullSelectedValue:""})});d(this,"handleClearInput",()=>{this.setState({userInput:"",selectedLanguage:"",selectedLevel:"",fullSelectedValue:"",pages:[]})});d(this,"filterChineseCharacters",t=>t.replace(/[^\u4e00-\u9fff]/g,""));d(this,"generateRandomColorsForPage",(t,n)=>{const s=I[n].colors,r=Math.min(t.length,5),l=v(s).slice(0,r);return t.map((i,a)=>l[a%l.length])});d(this,"generatePages",()=>{const{wordsPerPage:t,selectedPreset:n}=this.state,{userInput:s}=this.state;if(!s.trim()){alert("请输入要练习的文字");return}if(t<2||t>5){alert("每页字数必须在2-5之间");return}this.setState({userInput:s},()=>{let r=[];s.trim()!==""&&(r=s.split(/[\s,;，；、]+/).filter(a=>a.trim()!=="")),r.length===0&&s.trim()!==""&&(r=s.split("").filter(a=>a.trim()!==""));const l=Math.ceil(r.length/t),i=[];for(let a=0;a<l;a++){const f=a*t,y=f+t,u=r.slice(f,y);if(u.length<t){const W=t-u.length;u.push(...r.slice(0,W))}const j=this.generateRandomColorsForPage(u,n);i.push({chars:u,colors:j})}this.setState({pages:i})})});this.state={userInput:"",wordsPerPage:3,selectedPreset:0,selectedLanguage:"",selectedLevel:"",fullSelectedValue:"",pages:[]}}render(){const{userInput:t,wordsPerPage:n,selectedPreset:s,fullSelectedValue:r,pages:l}=this.state;return e.jsx(o,{className:"app",sx:{p:2},children:e.jsx(N,{maxWidth:"lg",children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{size:{xs:12,md:12},sx:{"@media print":{display:"none"}},children:e.jsxs(w,{sx:{p:3},children:[e.jsx(o,{sx:{mb:3},children:e.jsxs(C,{fullWidth:!0,children:[e.jsxs(o,{sx:{display:"flex",gap:1,alignItems:"flex-start"},children:[e.jsx($,{multiline:!0,rows:3,value:t,onChange:this.handleUserInputChange,placeholder:`请输入最多${P}个要练习的文字`,inputProps:{maxLength:P},fullWidth:!0,variant:"outlined"}),e.jsx(F,{onClick:this.handleClearInput,disabled:!t,color:"error",sx:{mt:.5},children:e.jsx(R,{})})]}),e.jsxs(x,{variant:"caption",color:"textSecondary",sx:{mt:1},children:["已输入 ",t.length,"/",P," 字"]})]})}),e.jsxs(p,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(p,{size:{xs:12,sm:4},children:e.jsxs(C,{fullWidth:!0,children:[e.jsx(b,{children:"每页字数"}),e.jsxs(S,{value:n,onChange:this.handleWordsPerPageChange,label:"每页字数",children:[e.jsx(g,{value:2,children:"2字/页"}),e.jsx(g,{value:3,children:"3字/页"}),e.jsx(g,{value:4,children:"4字/页"}),e.jsx(g,{value:5,children:"5字/页"})]})]})}),e.jsx(p,{size:{xs:12,sm:4},children:e.jsxs(C,{fullWidth:!0,children:[e.jsx(b,{children:"颜色色系"}),e.jsx(S,{value:s,onChange:this.handleColorPresetChange,label:"颜色色系",children:I.map((i,a)=>e.jsx(g,{value:a,children:i.name},a))})]})}),e.jsx(p,{size:{xs:12,sm:4},children:e.jsxs(C,{fullWidth:!0,children:[e.jsx(b,{children:"预设字库"}),e.jsxs(S,{value:r,onChange:this.handleLevelChange,label:"预设字库",children:[e.jsx(g,{value:"",children:"请选择字库"}),Object.keys(m).map(i=>Object.keys(m[i]).map(a=>e.jsxs(g,{value:`${i}|${a}`,children:[i," - ",a]},`${i}-${a}`)))]})]})})]}),e.jsxs(o,{sx:{mb:3,"@media print":{display:"none"}},children:[e.jsx(x,{variant:"subtitle1",gutterBottom:!0,children:"当前色系"}),e.jsx(o,{sx:{display:"flex",gap:1,mb:1},children:I[s].colors.map((i,a)=>e.jsx(o,{sx:{width:40,height:40,backgroundColor:i,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:1,border:"1px solid #ccc"},title:i,children:e.jsx(x,{variant:"caption",sx:{color:"white",textShadow:"1px 1px 2px black"},children:a+1})},a))}),e.jsxs(x,{variant:"caption",color:"textSecondary",children:["每页将随机使用其中的 ",n," 种颜色，确保颜色区分明显"]})]}),e.jsx(k,{variant:"contained",fullWidth:!0,onClick:this.generatePages,disabled:!t.trim(),size:"large",sx:{"@media print":{display:"none"}},children:"生成练习页"})]})}),e.jsx(p,{size:{xs:12,md:12},sx:{"@media print":{width:"100%",maxWidth:"100%",flexBasis:"100%"}},children:e.jsx(w,{sx:{p:3,minHeight:400,"@media print":{boxShadow:"none",border:"none",minHeight:"auto"}},children:l.length>0?e.jsx(X,{pages:l.map((i,a)=>({characters:i.chars,colors:i.colors,pageNumber:a+1,totalPages:l.length}))}):e.jsx(o,{sx:{textAlign:"center",py:8,"@media print":{display:"none"}},children:e.jsx(x,{variant:"h6",color:"textSecondary",children:'请输入文字并点击"生成练习页"来预览'})})})})]})})})}}function D(h){const c=/[\u4e00-\u9fff]/;return h.some(t=>c.test(t))}const U=h=>{if(h.length===0)return[];const c=h.flatMap(r=>[...r]);let t=[];const n=[];let s=[];D(h)?s=m.Chinese[G]||[]:s=[...m.English[H],...m.English[O]],t=t.concat(s),t=v(t);for(let r=0;r<7;r++){t=v(t);const l=t.slice(0,7-c.length);let i=[...c,...l];i=v(i),n.push(i)}return n};class X extends L.Component{constructor(t){super(t);d(this,"goToPreviousPage",()=>{this.setState(t=>({currentPage:Math.max(0,t.currentPage-1)}))});d(this,"goToNextPage",()=>{const{pages:t}=this.props;this.setState(n=>({currentPage:Math.min(t.length-1,n.currentPage+1)}))});d(this,"goToPage",t=>{this.setState({currentPage:t})});d(this,"generatePageIndicators",()=>{const{pages:t}=this.props,{currentPage:n}=this.state,s=t.length;if(s<=7)return Array.from({length:s},(l,i)=>i);const r=[];if(r.push(0),n<=3){for(let l=1;l<=4;l++)r.push(l);r.push("ellipsis"),r.push(s-2),r.push(s-1)}else if(n>=s-4){r.push("ellipsis");for(let l=s-5;l<s;l++)l>0&&r.push(l)}else{r.push("ellipsis");for(let l=n-2;l<=n+2;l++)r.push(l);r.push("ellipsis"),r.push(s-1)}return r});d(this,"renderPage",t=>{const{characters:n,colors:s}=t,r=U(n);return e.jsxs(o,{sx:{p:2},children:[e.jsx(x,{variant:"h1",align:"center",gutterBottom:!0,sx:{fontWeight:"bold",my:4},children:"找一找 涂色"}),e.jsx(o,{sx:{display:"flex",justifyContent:"center",gap:3,my:5,flexWrap:"wrap"},children:n.map((i,a)=>e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(o,{sx:{width:"12mm",height:"12mm",backgroundColor:s[a],borderRadius:"50%",border:"2px solid #333",aspectRatio:"1"}}),e.jsx(x,{variant:"h4",sx:{width:"12mm",height:"12mm",textAlign:"center"},children:i})]},a))}),e.jsx(o,{sx:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"5mm",margin:"0 auto",maxWidth:"180mm"},children:Array.from({length:49}).map((i,a)=>{var j;const f=Math.floor(a/7),y=a%7,u=((j=r[f])==null?void 0:j[y])||"";return e.jsx(o,{sx:{width:"20mm",height:"20mm",aspectRatio:"1",border:"0.75pt solid #333",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"white"},children:e.jsx(x,{variant:"h3",children:u})},a)})})]})});d(this,"handlePrint",()=>{window.print()});this.state={currentPage:0}}render(){const{pages:t}=this.props,{currentPage:n}=this.state;return!t||t.length===0?e.jsx(o,{sx:{textAlign:"center",py:8},children:e.jsx(x,{variant:"h6",color:"textSecondary",children:"没有可预览的页面"})}):e.jsxs(o,{children:[e.jsxs(o,{sx:{"@media print":{display:"none"}},children:[e.jsx(o,{sx:{mb:2},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:2},children:[e.jsx(F,{onClick:this.goToPreviousPage,disabled:n===0,children:e.jsx(M,{})}),e.jsx(o,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:this.generatePageIndicators().map((s,r)=>s==="ellipsis"?e.jsx(x,{sx:{px:1},children:"..."},`ellipsis-${r}`):e.jsx(F,{onClick:()=>this.goToPage(s),color:s===n?"primary":"default",size:"small",children:s+1},s))}),e.jsx(F,{onClick:this.goToNextPage,disabled:n===t.length-1,children:e.jsx(_,{})})]})}),e.jsx(o,{sx:{mb:3},children:this.renderPage(t[n])}),e.jsx(o,{sx:{textAlign:"center"},children:e.jsxs(k,{variant:"outlined",startIcon:e.jsx(z,{}),onClick:this.handlePrint,children:["打印所有页面 (",t.length,"页)"]})})]}),e.jsx(o,{sx:{display:"none","@media print":{display:"block"}},children:t.map((s,r)=>e.jsx(o,{sx:{breakAfter:"page",pageBreakAfter:"always","&:last-child":{breakAfter:"auto",pageBreakAfter:"auto"}},children:this.renderPage(s)},r))})]})}}function re(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:`Chinese Coloring - ${T.appName}`}),e.jsx(V,{})]})}export{re as default};
